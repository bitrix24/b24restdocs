# How to Upload Files

In Bitrix24, there are two types of file fields.

- **File.** This field is not linked to Drive; files are uploaded directly through a Base64 formatted string.

- **File (Drive).** This field is linked to Drive, and it stores the ID of the Drive object. The Base64 format is not processed in this field, so the file must first be uploaded to Bitrix24 Drive using the methods [disk.folder.uploadfile](../disk/folder/disk-folder-upload-file.md) or [disk.storage.uploadfile](../disk/storage/disk-storage-upload-file.md).

To upload files to Bitrix24, use the standard Base64 encoding. Encoding is used when you need to transmit a file through text protocols, such as HTTP.

## How to Encode a File in Base64

In JavaScript, you can use the built-in [FileReader](https://www.w3.org/TR/FileAPI/) object. The code reads the file selected by the user and converts it to Base64.

```JavaScript
const fileInput = document.getElementById('fileInput'); // File selection field

fileInput.addEventListener('change', function() {
    const file = fileInput.files[0]; // Get the selected file
    const reader = new FileReader();

    reader.onload = function() {
        const base64 = reader.result.split(',')[1]; // Get base64 without prefix
        console.log(base64); // Output the result
    };

    reader.readAsDataURL(file); // Encode the file in base64
});
```

In PHP, you can use the [base64_encode](https://www.php.net/manual/en/function.base64-encode.php) function. The code reads the file from the disk and encodes it in Base64.

```PHP
$filePath = 'path/to/your/file.jpg'; // Path to the file
$fileData = file_get_contents($filePath); // Read the file
$base64 = base64_encode($fileData); // Encode to base64
```

As a result of encoding the file, you will get a string like `YmFzZSDRgtC10YHRgg==`. The larger the file size, the longer the string will be.

## How to Pass a Base64 String to a Field

In Bitrix24, there are 4 features for uploading files.

1. Pass the Base64 string to the `file` field if you are using the methods:

   - [documentgenerator.template.add](../document-generator/templates/document-generator-template-add.md)

   - [crm.documentgenerator.template.add](../crm/document-generator/templates/crm-document-generator-template-add.md)

    {% list tabs %}

    - JS
    
        ```JavaScript
        BX24.callMethod(
            'documentgenerator.template.add',
            {
                fields: {
                    name: "Template Example",
                    file: "base64_encoded_content_here", // File content encoded in base64
                    code: "example_template_code"
                }
            }
        );
        ```

    - PHP
    
        ```php
        require_once('crest.php');

        $result = CRest::call(
            'documentgenerator.template.add',
            [
                'fields' => [
                    'name' => 'Template Example',
                    'file' => 'base64_encoded_content_here', // File content encoded in base64
                    'code' => 'example_template_code' 
                ]
            ]
        );
        ```

    - cURL (OAuth)

        ```bash
        curl -X POST \
        -H "Content-Type: application/json" \
        -H "Accept: application/json" \
        -d '{"fields":{"name":"Template Example","file":"base64_encoded_content_here","code":"example_template_code"},"auth":"**put_access_token_here**"}' \
        https://**put_your_bitrix24_address**/rest/documentgenerator.template.add
        ```

    - cURL (Webhook)

        ```bash
        curl -X POST \
        -H "Content-Type: application/json" \
        -H "Accept: application/json" \
        -d '{"fields":{"name":"Template Example","file":"base64_encoded_content_here","code":"example_template_code"}}' \
        https://**put_your_bitrix24_address**/rest/**put_your_user_id_here**/**put_your_webbhook_here**/documentgenerator.template.add
        ```

    {% endlist %}

2. Pass an array of the file name and Base64 string if you are using the methods:

   - [crm.timeline.comment.add](../crm/timeline/comments/crm-timeline-comment-add.md) — in the `FILES` field

   - [crm.item.add](../crm/universal/crm-item-add.md) — in file-type fields of CRM entities

   - [log.blogpost.add](../log/log-blogpost-add.md) — in the `FILES` field

   - [lists.element.add](../lists/elements/lists-element-add.md) — in file-type properties

   - [entity.item.add](../entity/items/entity-item-add.md) — in file-type properties

   - [bizproc.workflow.template.add](../bizproc/template/bizproc-workflow-template-add.md) — in the `TEMPLATE_DATA` field

    {% list tabs %}

    - JS
    
        ```JavaScript
        BX24.callMethod(
            'bizproc.workflow.template.add',
            {
                DOCUMENT_TYPE: ['lists', 'BizprocDocument', 'iblock_164'],
                NAME: 'App template', 
                // File content with the business process template
                TEMPLATE_DATA: [   
                    "bp-379.bpt", // First element of the array - file name
                    "base64_encoded_content_here" // Second element of the array - file content encoded in base64
                ]
            }
        );
        ```

    - PHP
    
        ```php
        require_once('crest.php');

        $result = CRest::call(
            'bizproc.workflow.template.add',
            [
                'DOCUMENT_TYPE' => ['lists', 'BizprocDocument', 'iblock_164'],
                'NAME' => 'App template',
                // File content with the business process template
                'TEMPLATE_DATA' => [
                    'bp-379.bpt', // File name
                    'base64_encoded_content_here' // File content encoded in base64
                ]
            ]
        );
        ```

    - cURL (OAuth)

        ```bash
        curl -X POST \
        -H "Content-Type: application/json" \
        -H "Accept: application/json" \
        -d '{"DOCUMENT_TYPE":["lists","BizprocDocument","iblock_164"],"NAME":"App template","TEMPLATE_DATA":["bp-379.bpt","base64_encoded_content_here"],"auth":"**put_access_token_here**"}' \
        https://**put_your_bitrix24_address**/rest/bizproc.workflow.template.add
        ```

    - cURL (Webhook)

        ```bash
        curl -X POST \
        -H "Content-Type: application/json" \
        -H "Accept: application/json" \
        -d '{"DOCUMENT_TYPE":["lists","BizprocDocument","iblock_164"],"NAME":"App template","TEMPLATE_DATA":["bp-379.bpt","base64_encoded_content_here"]}' \
        https://**put_your_bitrix24_address**/rest/**put_your_user_id_here**/**put_your_webbhook_here**/bizproc.workflow.template.add
        ```

    {% endlist %}

3. Pass an object with the key `fileData`, which contains an array of the file name and Base64 string if you are using the methods:

   - [catalog.product.add](../catalog/product/catalog-product-add.md) — in the `previewPicture`, `detailPicture` fields

    {% list tabs %}

    - JS
    
        ```JavaScript
        BX24.callMethod(
            "catalog.product.add",
            {
                fields: {
                    iblockId: '24', 
                    name: "Product Example",
                    // Preview image of the product, fileData - array where the first element is the file name, the second is the file content in base64 format
                    previewPicture: {
                        fileData: [
                            "example.jpg", // Image file name
                            "base64_encoded_content_here" // Image content in base64 format
                        ]
                    }
                }
            }
        );
        ```

    - PHP
    
        ```php
        require_once('crest.php');

        $result = CRest::call(
            'catalog.product.add',
            [
                'fields' => [
                    'iblockId' => '24', 
                    'name' => 'Product Example', 
                    // Preview image of the product, fileData - array where the first element is the file name, the second is the file content in base64 format            
                    'previewPicture' => [
                        'fileData' => [
                            'example.jpg', // Image file name
                            'base64_encoded_content_here' // Image content in base64 format
                        ]
                    ]
                ]
            ]
        );
        ```

    - cURL (OAuth)

        ```bash
        curl -X POST \
        -H "Content-Type: application/json" \
        -H "Accept: application/json" \
        -d '{"fields":{"iblockId":"24","name":"Product Example","previewPicture":{"fileData":["example.jpg","base64_encoded_content_here"]}},"auth":"**put_access_token_here**"}' \
        https://**put_your_bitrix24_address**/rest/catalog.product.add
        ```

    - cURL (Webhook)

        ```bash
        curl -X POST \
        -H "Content-Type: application/json" \
        -H "Accept: application/json" \
        -d '{"fields":{"iblockId":"24","name":"Product Example","previewPicture":{"fileData":["example.jpg","base64_encoded_content_here"]}}}' \
        https://**put_your_bitrix24_address**/rest/**put_your_user_id_here**/**put_your_webbhook_here**/catalog.product.add
        ```

    {% endlist %}

4. Pass the `fileContent` parameter, which contains an array of the file name and Base64 string if you are using the methods:

   - [disk.file.uploadversion](../disk/file/disk-file-upload-version.md)

   - [disk.storage.uploadfile](../disk/storage/disk-storage-upload-file.md)

   - [disk.folder.uploadfile](../disk/folder/disk-folder-upload-file.md)

   - [telephony.externalCall.attachRecord](../telephony/telephony-external-call-attach-record.md)

   - [catalog.productImage.add](../catalog/product-image/catalog-product-image-add.md)

    {% list tabs %}

    - JS
    
        ```JavaScript
        BX24.callMethod(
            "disk.file.uploadversion",
            {    
                id: 4, // Identifier of the file for which a new version is being uploaded
                // Content of the file being uploaded as a new version
                fileContent: [
                    '1.gif', // First element of the array - file name
                    'base64_encoded_content_here' // Second element of the array - file content in base64 format
                ]
            }
        );
        ```

    - PHP
    
        ```php
        require_once('crest.php');

        $result = CRest::call(
            'disk.file.uploadversion',
            [
                'id' => 4, // Identifier of the file for which a new version is being uploaded
                'fileContent' => [
                    '1.gif', // File name
                    'base64_encoded_content_here' // File content in base64 format
                ]
            ]
        );
        ```

    - cURL (OAuth)

        ```bash
        curl -X POST \
        -H "Content-Type: application/json" \
        -H "Accept: application/json" \
        -d '{"id":4,"fileContent":["1.gif","base64_encoded_content_here"],"auth":"**put_access_token_here**"}' \
        https://**put_your_bitrix24_address**/rest/disk.file.uploadversion
        ```

    - cURL (Webhook)

        ```bash
        curl -X POST \
        -H "Content-Type: application/json" \
        -H "Accept: application/json" \
        -d '{"id":4,"fileContent":["1.gif","base64_encoded_content_here"]}' \
        https://**put_your_bitrix24_address**/rest/**put_your_user_id_here**/**put_your_webbhook_here**/disk.file.uploadversion
        ```

    {% endlist %}

## How to Upload Files to a Multiple Field

If the field has a "multiple" flag, you can upload several files to it. Uploading multiple files works in the following methods:

- [crm.item.add](../crm/universal/crm-item-add.md) — file-type fields

- [lists.element.add](../lists/elements/lists-element-add.md) — file-type properties

- [crm.timeline.comment.add](../crm/timeline/comments/crm-timeline-comment-add.md) — `FILES` field

- [log.blogpost.add](../log/log-blogpost-add.md) — `FILES` field

- [catalog.product.add](../catalog/product/catalog-product-add.md) — file-type fields

To upload multiple files, pass an array where each element is the file name and the file itself, in a Base64 encoded string format.

{% list tabs %}

- JS
  
    ```JavaScript
    BX24.callMethod(
        'crm.item.add',
        {
            entityTypeId: 2, 
            fields: {
                title: "New Deal (specifically for REST method example)", 
                // Multiple field with an array of files
                ufCrm_123456: [ 
                    [
                        "green_pixel.png", // File name #1
                        "base64_encoded_content_here" // Base64 content of the first file
                    ],
                    [
                        "blue_pixel.png", // File name #2
                        "base64_encoded_content_here" // Base64 content of the second file
                    ],
                    [
                        "red_pixel.png", // File name #3
                        "base64_encoded_content_here" // Base64 content of the third file
                    ]
                ]
            }
        }
    );
    ```

- PHP

    ```php
    require_once('crest.php');

    $result = CRest::call(
        'crm.item.add',
        [
            'entityTypeId' => 2, 
            'fields' => [
                'title' => 'New Deal (specifically for REST method example)', 
                // Multiple field with an array of files
                'ufCrm_123456' => [
                    [
                        'green_pixel.png', // File name #1
                        'base64_encoded_content_here' // Base64 content of the first file
                    ],
                    [
                        'blue_pixel.png', // File name #2
                        'base64_encoded_content_here' // Base64 content of the second file
                    ],
                    [
                        'red_pixel.png', // File name #3
                        'base64_encoded_content_here' // Base64 content of the third file
                    ]
                ]
            }
        ]
    );
    ```

- cURL (OAuth)

    ```bash
    curl -X POST \
    -H "Content-Type: application/json" \
    -H "Accept: application/json" \
    -d '{"entityTypeId":2,"fields":{"title":"New Deal (specifically for REST method example)","ufCrm_123456":[["green_pixel.png","base64_encoded_content_here"],["blue_pixel.png","base64_encoded_content_here"],["red_pixel.png","base64_encoded_content_here"]]},"auth":"**put_access_token_here**"}' \
    https://**put_your_bitrix24_address**/rest/crm.item.add
    ```

- cURL (Webhook)

    ```bash
    curl -X POST \
    -H "Content-Type: application/json" \
    -H "Accept: application/json" \
    -d '{"entityTypeId":2,"fields":{"title":"New Deal (specifically for REST method example)","ufCrm_123456":[["green_pixel.png","base64_encoded_content_here"],["blue_pixel.png","base64_encoded_content_here"],["red_pixel.png","base64_encoded_content_here"]]}}' \
    https://**put_your_bitrix24_address**/rest/**put_your_user_id_here**/**put_your_webbhook_here**/crm.item.add
    ```

{% endlist %}

To upload multiple files in the method [catalog.product.add](../catalog/product/catalog-product-add.md), pass an array of objects, where each object contains the `value` field, which holds an object with the `fileData` key. The value of `fileData` is an array of two elements: the file name and the file itself, in a Base64 encoded string format.

{% list tabs %}

- JS

    ```js
    BX24.callMethod(
        'catalog.product.add',
        {
            fields: {
                iblockId: 1,
                name: "Product Example",
                PROPERTY_1077: [
                    {
                        value: {
                            fileData: [
                                "blue_pixel.txt", // File name
                                "YmFzZSDRgtC10YHRgg==" // Base64 content
                            ]
                        }
                    },
                    {
                        value: {
                            fileData: [
                                "red_pixel.txt", // File name
                                "YmFzZSDRgtC10YHRgg==" // Base64 content
                            ]
                        }
                    }
                ]
            }
        }
    );
    ```

- cURL (Webhook)

    ```bash
    curl -X POST -H "Content-Type: application/json" -H "Accept: application/json" -d '{"fields": {"iblockId": 1, "name": "Product Example", "PROPERTY_1077": [{"value": {"fileData": ["blue_pixel.txt", "YmFzZSDRgtC10YHRgg=="]}}, {"value": {"fileData": ["red_pixel.txt", "YmFzZSDRgtC10YHRgg=="]}}]}}' https://**put_your_bitrix24_address**/rest/**put_your_user_id_here**/**put_your_webbhook_here**/catalog.product.add
    ```

- cURL (OAuth)

    ```bash
    curl -X POST -H "Content-Type: application/json" -H "Accept: application/json" -d '{"fields": {"iblockId": 1, "name": "Product Example", "PROPERTY_1077": [{"value": {"fileData": ["blue_pixel.txt", "YmFzZSDRgtC10YHRgg=="]}}, {"value": {"fileData": ["red_pixel.txt", "YmFzZSDRgtC10YHRgg=="]}}]}, "auth": "**put_access_token_here**"}' https://**put_your_bitrix24_address**/rest/catalog.product.add
    ```

- PHP

    ```php
    require_once('crest.php');

    $result = CRest::call(
        'catalog.product.add',
        [
            'fields' => [
                'iblockId' => 1,
                'name' => 'Product Example',
                'PROPERTY_1077' => [
                    [
                        'value' => [
                            'fileData' => [
                                'blue_pixel.txt',
                                'YmFzZSDRgtC10YHRgg=='
                            ]
                        ]
                    },
                    [
                        'value' => [
                            'fileData' => [
                                'red_pixel.txt',
                                'YmFzZSDRgtC10YHRgg=='
                            ]
                        ]
                    }
                ]
            ]
        ]
    );

    echo '<PRE>';
    print_r($result);
    echo '</PRE>';
    ```

{% endlist %}


## Limitations When Working with Files

- The limit on the length of a GET request is 2048 characters, which is the length of the URL. Files encoded in Base64 often exceed this value. To transmit large files, use a POST request.

- The limit on the size of a POST request in Bitrix24 is 2GB. Files larger than 2GB will not be processed. If multiple files are sent in one request totaling more than 2GB, the request will be interrupted. To upload several large files, send the data in separate requests.

- The limit on the execution time of a request is 60 seconds for cloud Bitrix24. The request will be interrupted due to a timeout if processing takes longer than 60 seconds. You can check the execution time of the request in the [time](../data-types.md#time) object of the response, parameter `duration`.

- If you are transmitting a file encoded as a Base64 string, and the method is executed in the address bar as a GET request or the method is executed via curl — Base64 needs to be additionally [encoded in urlencode](../../settings/how-to-call-rest-api/data-encoding.md), otherwise, the file will not be read.